<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Diagn√≥stico BRMobility</title>
<style>
  :root{
    --accent:#1fa3a8; /* cor principal (ajust√°vel) */
    --dark:#222;
    --muted:#666;
    --card:#fff;
  }
  html,body{height:100%; margin:0; font-family:Arial,Helvetica,sans-serif; background:#fbfcfd;}
  body{
    padding:18px;
    box-sizing:border-box;
    background-image: url('logo novo.jpg');
    background-repeat:no-repeat;
    background-position:center top;
    background-size: 600px auto;
  }
  /* leve overlay para deixar o logo opaco e foco no conte√∫do */
  body::before{content:""; position:fixed; inset:0; pointer-events:none; background:linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.98));}
  .wrap{max-width:760px; margin:0 auto; position:relative; z-index:2;}
  h1{font-size:1.5rem; margin:0 0 6px; color:var(--dark); font-weight:800;}
  .subtitle{margin:0 0 10px; color:#333; font-size:0.95rem;}
  .alert{display:flex; gap:8px; align-items:center; color:#a33; font-size:0.87rem; margin-bottom:12px;}
  .field{margin:10px 0;}
  input[type=text], textarea{
    width:100%; padding:11px; font-size:1rem; border-radius:8px; border:1px solid #d6dde0; box-sizing:border-box; background:var(--card);
  }
  textarea{resize:vertical;}
  .sectionTitle{margin-top:12px; font-weight:700; color:var(--dark);}
  .choices{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
  .choiceBtn{background:var(--accent); color:#fff; padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:700;}
  .muted{color:var(--muted); font-size:0.92rem;}
  .infoBox{background:#fff; border:1px solid #e6ecec; padding:10px; margin-top:10px; border-radius:8px; color:#222;}
  .spaced{margin-top:28px;} /* aumenta espa√ßo para "Nenhuma..." */
  .small{font-size:0.9rem; color:#444;}
  .inlineRow{display:flex; gap:8px; align-items:center;}
  .resBtns{display:flex; gap:8px; margin-top:10px;}
  .resBtn{background:#2b9d8a; color:#fff; padding:8px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:700;}
  .whatsapp-btn{display:flex; gap:12px; align-items:center; margin-top:14px; cursor:pointer;}
  .whatsapp-btn img{width:56px; height:56px; border-radius:8px; object-fit:cover;}
  .whatsappLabel{background:var(--accent); color:#fff; padding:10px 14px; border-radius:8px; font-weight:800;}
  @media(max-width:420px){ h1{font-size:1.2rem;} .whatsapp-btn img{width:48px;height:48px;} }
</style>
</head>
<body>
<div class="wrap">

  <!-- Cabe√ßalho / Se√ß√£o 01 -->
  <h1>An√°lise e Reparo em Campo Grupo BRMobility</h1>
  <p class="subtitle">Este site auxilia as manuten√ß√µes em campo dos T√©cnicos Externos, oferecendo velocidade em diagn√≥stico e reparos e instru√ß√£o t√©cnica dos ve√≠culos do Grupo BRMobility.</p>
  <p class="alert">‚ö†Ô∏è <span class="small">Esse site n√£o deve ser compartilhado com clientes ou pessoas fora do Grupo BRMobility.</span></p>

  <!-- Campos iniciais -->
  <div class="field">
    <label class="small">N√∫mero do chamado</label>
    <input id="chamado" type="text" placeholder="por exemplo #20991">
  </div>
  <div class="field">
    <label class="small">Nome do posto</label>
    <input id="posto" type="text" placeholder="por exemplo Shopping BRMobility">
  </div>
  <div class="field">
    <label class="small">N√∫mero de patrim√¥nio</label>
    <input id="patrimonio" type="text" placeholder="por exemplo 0123">
  </div>

  <!-- Se√ß√£o 02: modelos (aparece s√≥ ap√≥s preencher os 3 campos iniciais) -->
  <div id="secao02" class="hidden">
    <div class="sectionTitle">Qual o modelo do ve√≠culo?</div>
    <div id="modelos" class="choices"></div>
  </div>

  <!-- Pergunta problema (aparece depois de escolher modelo) -->
  <div id="secaoProblema" class="hidden">
    <div class="sectionTitle">Qual o problema descrito no chamado ou informado pelo cliente?</div>
    <div class="field"><input id="problema" type="text" placeholder="Descreva o problema"></div>
    <div><button id="btnConfirmProblema" class="choiceBtn">Confirmar problema</button></div>
  </div>

  <!-- Se√ß√£o 03: Erros (aparece s√≥ se modelo = i2-X2) -->
  <div id="secaoErros" class="hidden">
    <div class="sectionTitle">O ve√≠culo apresenta algum desses erros? (toque no c√≥digo para ver mais)</div>
    <div id="errosList"></div>

    <div id="errosInfo" class="infoBox hidden"></div>

    <!-- "Nenhuma das op√ß√µes listadas" com maior espa√ßo -->
    <div class="spaced">
      <label><input id="nenhuma" type="checkbox"> <span class="small">Nenhuma das op√ß√µes listadas</span></label>
      <div id="descNenhumaWrap" class="hidden" style="margin-top:8px;">
        <textarea id="descNenhuma" rows="3" placeholder="Descreva o problema..."></textarea>
      </div>
    </div>

    <!-- Pergunta 'Foi poss√≠vel resolver' s√≥ aparece ap√≥s selecionar erro (exceto quando 'Nenhuma') -->
    <div id="resolvidoWrap" class="hidden">
      <div class="sectionTitle">Foi poss√≠vel resolver o chamado?</div>
      <div class="resBtns">
        <button id="resSim" class="resBtn">Sim</button>
        <button id="resNao" class="resBtn">N√£o</button>
      </div>
    </div>
  </div>

  <!-- Bot√µes WhatsApp (aparecem s√≥ depois de finalizado o fluxo) -->
  <div id="atendimento" class="hidden">
    <div class="sectionTitle">Enviar mensagem via WhatsApp</div>

    <div id="btnVanessa" class="whatsapp-btn">
      <img src="vanessa logo.jpg" alt="Vanessa">
      <div class="whatsappLabel">Atendimento Vanessa Maia</div>
    </div>

    <div id="btnWillian" class="whatsapp-btn">
      <img src="willainlogo.jpg" alt="Willian">
      <div class="whatsappLabel">Atendimento Willian Bertuzzi</div>
    </div>
  </div>

</div>

<script>
/* ====== Config ====== */
const NUM_VANESSA = "5511989477808";
const NUM_WILLIAN = "5511956544217";

/* ====== Dados ====== */
const ERROS_I2 = [
  {code:"C010/C018", issue:"Inclina√ß√£o frontal excessiva", info:"Inclina√ß√£o frontal excessiva. Solicite a troca do ve√≠culo imediatamente."},
  {code:"C020/C028", issue:"Inclina√ß√£o traseira excessiva", info:"Inclina√ß√£o traseira excessiva. Solicite a troca do ve√≠culo imediatamente."},
  {code:"C040/C048", issue:"Limitador de velocidade ativado", info:"Limitador de velocidade frontal/traseiro ativado. Realize o procedimento pelo link: clique aqui. (https://drive.google.com/file/d/1uHcirgVcKM_FAG7NPW4spNOP2jF6cpio/view?usp=drive_link)"},
  {code:"C100/C108", issue:"Bateria traseira/frontal vazia", info:"Bateria traseira/frontal vazia. Solicite a troca de bateria imediatamente."},
  {code:"C200/C208", issue:"Desligamento da bateria", info:"Desligamento da bateria traseira/frontal. Solicite a troca de bateria imediatamente."},
  {code:"C400/C408", issue:"√Çngulo de rota√ß√£o excedido", info:"√Çngulo de rota√ß√£o excedido. Realize a solicita√ß√£o de piv√¥ mec√¢nico para a troca."},
  {code:"C800/C808", issue:"Baixa voltagem do barramento", info:"Baixa voltagem do barramento. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E012/E01A/E01B", issue:"Falha comunica√ß√£o m√≥dulo CU", info:"Falha na comunica√ß√£o com o m√≥dulo CU. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E022/E02A/E02B", issue:"Falha comunica√ß√£o BSA", info:"Falha na comunica√ß√£o com o m√≥dulo BSA. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E042/E04A/E04B", issue:"Falha comunica√ß√£o BSA (var)", info:"Falha na comunica√ß√£o com o m√≥dulo BSA. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E082/E08A/E08B", issue:"Falha comunica√ß√£o UI", info:"Falha na comunica√ß√£o com o m√≥dulo UI. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E202/E20A/E20B", issue:"Falha slot TDM", info:"Falha no slot TDM. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E402/E40A/E40B", issue:"Falha remota com BSA", info:"Falha na comunica√ß√£o remota com o BSA. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E802/E80A/E80B", issue:"Falha remota com UI", info:"Falha na comunica√ß√£o remota com o UI. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E013/E01C/E02C", issue:"Falha comunica√ß√£o BCU", info:"Falha na comunica√ß√£o com o m√≥dulo BCU. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E014/E024/E044", issue:"Falha sensor de piv√¥", info:"Falha no sensor de piv√¥. Solicite um sensor de piv√¥ para a troca."},
  {code:"E084/E104/E204", issue:"Falha sensores auxiliares", info:"Falha nos sensores auxiliares. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E404/E40C", issue:"Falha sensor de detec√ß√£o piloto", info:"Falha no sensor de detec√ß√£o do piloto. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E804/E80C", issue:"Falha sensor alimenta√ß√£o", info:"Falha no sensor de alimenta√ß√£o. Solicite um conjunto de placa fonte para a troca."},
  {code:"E015/E025/E045", issue:"Falha sensores alimenta√ß√£o (12V,5V,3V)", info:"Falha nos sensores de alimenta√ß√£o (12V, 5V, 3V). Solicite imediatamente a troca do ve√≠culo."},
  {code:"E085/E105/E205", issue:"Falha sensor temperatura BSA", info:"Falha no sensor de temperatura do BSA. Solicite um par de baterias para a troca."},
  {code:"E105/E205/E405", issue:"Falha interna do BSA", info:"Falha interna do BSA. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E016/E026/E046", issue:"Falha temperatura da jun√ß√£o", info:"Falha na temperatura da jun√ß√£o. Solicite imediatamente a troca do ve√≠culo."},
  {code:"E086/E106/E206", issue:"Falha motor de acionamento", info:"Falha no motor de acionamento. Solicite um par de motores para a troca."},
  {code:"E406/E406", issue:"Falha amplificador corrente motor", info:"Falha no amplificador de corrente do motor. Solicite um par de motores para a troca."},
  {code:"E806/E806", issue:"Falha feedback voltagem motor", info:"Falha no feedback de voltagem do motor. Solicite um par de motores para a troca."},
  {code:"E017/E027/E047", issue:"Falha consist√™ncia voltagem motor", info:"Falha na consist√™ncia da voltagem do motor."},
  {code:"E087/E107/E207", issue:"Falha rel√© do motor", info:"Falha no rel√© do motor. Solicite um par de motores para a troca."},
  {code:"E407/E407", issue:"Falha alimenta√ß√£o do atuador", info:"Falha na consist√™ncia da alimenta√ß√£o do atuador. Solicite imediatamente a troca do ve√≠culo."}
];

/* ====== Elementos DOM ====== */
const chamadoEl = document.getElementById('chamado');
const postoEl = document.getElementById('posto');
const patrimonioEl = document.getElementById('patrimonio');
const secao02El = document.getElementById('secao02');
const modelosEl = document.getElementById('modelos');
const secaoProblemaEl = document.getElementById('secaoProblema');
const problemaEl = document.getElementById('problema');
const btnConfirmProblema = document.getElementById('btnConfirmProblema');
const secaoErrosEl = document.getElementById('secaoErros');
const errosListEl = document.getElementById('errosList');
const errosInfoEl = document.getElementById('errosInfo');
const nenhumaEl = document.getElementById('nenhuma');
const descNenhumaWrap = document.getElementById('descNenhumaWrap');
const descNenhumaEl = document.getElementById('descNenhuma');
const resolvidoWrap = document.getElementById('resolvidoWrap');
const resSim = document.getElementById('resSim');
const resNao = document.getElementById('resNao');
const atendimentoEl = document.getElementById('atendimento');
const btnVanessaEl = document.getElementById('btnVanessa');
const btnWillianEl = document.getElementById('btnWillian');

/* ====== Estado ====== */
const state = { modelo:null, problema:null, erros:[], resolvido:null };

/* ====== Fluxo: mostrar modelos s√≥ quando inputs iniciais preenchidos ====== */
function checkInitials(){
  if(chamadoEl.value.trim() && postoEl.value.trim() && patrimonioEl.value.trim()){
    secao02El.classList.remove('hidden');
  } else {
    secao02El.classList.add('hidden');
    secaoProblemaEl.classList.add('hidden');
    secaoErrosEl.classList.add('hidden');
    atendimentoEl.classList.add('hidden');
  }
}
[chamadoEl, postoEl, patrimonioEl].forEach(i => i.addEventListener('input', checkInitials));

/* montar bot√µes de modelos */
const modelos = ["i2-X2","i3-X3","S6","S8-R8-BR8","H9-H9X","S9-S9X","S10-S10X"];
modelos.forEach(m=>{
  const b = document.createElement('button');
  b.className = 'choiceBtn';
  b.innerText = m;
  b.onclick = ()=>{
    state.modelo = m;
    // reset later stages
    state.problema = null; state.erros = []; state.resolvido = null;
    errosInfoEl.classList.add('hidden'); descNenhumaWrap.classList.add('hidden');
    resolvidoWrap.classList.add('hidden'); atendimentoEl.classList.add('hidden');
    problemaEl.value = ''; descNenhumaEl.value = '';
    secaoProblemaEl.classList.remove('hidden');
    secaoErrosEl.classList.add('hidden');
  };
  modelosEl.appendChild(b);
});

/* confirmar problema */
btnConfirmProblema.addEventListener('click', ()=>{
  const txt = problemaEl.value.trim();
  if(!txt){ alert('Preencha o problema para continuar.'); return; }
  state.problema = txt;
  // se i2-X2 mostra lista completa
  if(state.modelo === 'i2-X2'){
    renderErrosI2();
    secaoErrosEl.classList.remove('hidden');
  } else {
    // vers√£o simplificada para outros modelos: mostrar apenas "nenhuma" alternativa (pede descri√ß√£o)
    errosListEl.innerHTML = '<div class="muted small">Lista de erros espec√≠fica do modelo n√£o dispon√≠vel aqui. Use "Nenhuma das op√ß√µes listadas" e descreva.</div>';
    secaoErrosEl.classList.remove('hidden');
  }
});

/* render erros i2 */
function renderErrosI2(){
  errosListEl.innerHTML = '';
  ERROS_I2.forEach((e, idx)=>{
    const row = document.createElement('div');
    row.style.marginBottom = '8px';
    const btn = document.createElement('button');
    btn.className = 'choiceBtn';
    btn.innerText = e.code;
    btn.onclick = ()=>{
      // mostrar info (solu√ß√£o) na caixa informativa
      errosInfoEl.classList.remove('hidden');
      errosInfoEl.innerHTML = `<strong>${e.code}</strong> ‚Äî ${e.info}`;
      // registrar para envio (mant√©m √∫nico)
      const entry = e.code + ": " + e.issue;
      if(!state.erros.includes(entry)) state.erros.push(entry);
      // mostrar op√ß√£o resolvido
      resolvidoWrap.classList.remove('hidden');
      atendimentoEl.classList.add('hidden'); // s√≥ ap√≥s resolver/confirmar iremos mostrar whatsapp
    };
    row.appendChild(btn);
    const span = document.createElement('span');
    span.className = 'muted';
    span.style.marginLeft='8px';
    span.innerText = e.issue;
    row.appendChild(span);
    errosListEl.appendChild(row);
  });
}

/* comportamento 'Nenhuma das op√ß√µes listadas' */
nenhumaEl.addEventListener('change', ()=>{
  if(nenhumaEl.checked){
    descNenhumaWrap.classList.remove('hidden');
    // limpar erros anteriores e info
    state.erros = [];
    errosInfoEl.classList.add('hidden');
    resolvidoWrap.classList.add('hidden');
    atendimentoEl.classList.add('hidden');
    // quando digitar no textarea, avan√ßar para pergunta resolvido automaticamente
    descNenhumaEl.focus();
  } else {
    descNenhumaWrap.classList.add('hidden');
    descNenhumaEl.value = '';
  }
});
descNenhumaEl.addEventListener('input', ()=>{
  if(descNenhumaEl.value.trim().length > 0){
    // registra texto como erro
    const txtEntry = "Nenhuma das op√ß√µes listadas: " + descNenhumaEl.value.trim();
    state.erros = [txtEntry];
    // mostrar pergunta resolvido
    resolvidoWrap.classList.remove('hidden');
    atendimentoEl.classList.add('hidden');
  } else {
    resolvidoWrap.classList.add('hidden');
    atendimentoEl.classList.add('hidden');
    state.erros = [];
  }
});

/* resolvido Sim/N√£o */
resSim.addEventListener('click', ()=>{ state.resolvido = "Sim"; finalizarFluxo(); });
resNao.addEventListener('click', ()=>{ state.resolvido = "N√£o"; finalizarFluxo(); });

/* montar e enviar mensagem ‚Äî SEM pr√©-visualiza√ß√£o na p√°gina; apenas abre WhatsApp com texto pronto */
function finalizarFluxo(){
  // valida√ß√µes finais
  if(nenhumaEl.checked){
    if(!descNenhumaEl.value.trim()){ alert('Descreva o problema em "Nenhuma das op√ß√µes listadas".'); return; }
  } else {
    if(state.erros.length === 0){ alert('Selecione ao menos um erro ou marque "Nenhuma das op√ß√µes listadas".'); return; }
  }
  // montar mensagem com emojis e respostas em negrito (*) para WhatsApp
  const chamado = chamadoEl.value.trim();
  const posto = postoEl.value.trim();
  const patrimonio = patrimonioEl.value.trim();
  const modelo = state.modelo || '';
  const problema = state.problema || '';
  const errosText = state.erros.join('; ');

  let mensagem = "";
  mensagem += "üìå *Chamado:* " + "*" + chamado + "*\n";
  mensagem += "üè¢ *Posto:* " + "*" + posto + "*\n";
  mensagem += "üîñ *Patrim√¥nio:* " + "*" + patrimonio + "*\n";
  mensagem += "üõû *Modelo:* " + "*" + modelo + "*\n";
  mensagem += "üìù *Problema:* " + "*" + problema + "*\n";
  mensagem += "‚ö†Ô∏è *Erros:* " + "*" + errosText + "*\n";
  if(state.resolvido !== null){
    mensagem += "‚úÖ *Foi poss√≠vel resolver?:* " + "*" + state.resolvido + "*\n";
  }
  mensagem += "\nüîß Enviado via app BRMobility";

  // configurar bot√µes para abrir o WhatsApp com mensagem codificada
  btnVanessaEl.onclick = ()=>{ window.open("https://wa.me/" + NUM_VANESSA + "?text=" + encodeURIComponent(mensagem), "_blank"); };
  btnWillianEl.onclick = ()=>{ window.open("https://wa.me/" + NUM_WILLIAN + "?text=" + encodeURIComponent(mensagem), "_blank"); };

  // mostrar √°rea de atendimento
  atendimentoEl.classList.remove('hidden');

  // rolar at√© os bot√µes para melhor UX
  setTimeout(()=> atendimentoEl.scrollIntoView({behavior:'smooth', block:'center'}),100);
}

/* Seguran√ßa: garantir que usu√°rio n√£o veja preview; tudo via WhatsApp */
/* Inicial */
(function init(){
  // nada extra; page requires JS
})();
</script>
</body>
</html>


